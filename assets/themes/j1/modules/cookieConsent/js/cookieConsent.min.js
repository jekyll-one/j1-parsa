/*
 # -----------------------------------------------------------------------------
 # ~/assets/themes/j1/modules/cookieConsent/js/cookieConsent.min.js
 # Provides JS Core for J1 Module BS Cookie Consent
 #
 #  Product/Info:
 #  https://shaack.com
 #  http://jekyll.one
 #
 #  Copyright (C) 2020 Stefan Haack
 #  Copyright (C) 2023 Juergen Adams
 #
 #  bootstrap-cookie-banner is licensed under MIT License.
 #  See: https://github.com/shaack/bootstrap-cookie-banner/blob/master/LICENSE
 #  J1 Theme is licensed under MIT License.
 #  See: https://github.com/jekyll-one/J1 Theme/blob/master/LICENSE
 # -----------------------------------------------------------------------------
 # TODO:
 #
 # -----------------------------------------------------------------------------
 # NOTE:
 #  BS Cookie Consent is a MODIFIED version of bootstrap-cookie-banner
 #  for the use with J1 Theme. This modified version cannot be used
 #  outside of J1 Theme!
 # -----------------------------------------------------------------------------
*/
"use strict";function CookieConsent(o){var e,t=log4javascript.getLogger("j1.core.CookieConsent"),n=this,i=!1,a=!!new liteURL(window.location.href).protocol.includes("https");for(var s in t.info("\ninitializing core module: started"),t.info("\nstate: started"),this.props={autoShowDialog:!0,dialogLanguage:"content",dialogLanguages:["en","de"],contentURL:"/assets/data/cookieconsent",postSelectionCallback:"",whitelisted:[],xhrDataElement:"consent-data",dialogContainerID:"consent-modal"},o)this.props[s]=o[s];-1!==this.props.dialogLanguage.indexOf("-")&&(this.props.dialogLanguage=this.props.dialogLanguage.split("-")[0]),this.props.dialogLanguages.includes(this.props.dialogLanguage)||(this.props.dialogLanguage=this.props.dialogLanguages[0]),this.props.xhrDataElement=this.props.xhrDataElement+"-"+this.props.dialogLanguage,this.props.cookieSecure=a;var l={set:function(o,e,t,n,i,a){var s=window.btoa(e),l="; expires=Thu, 01 Jan 1970 00:00:00 UTC";if(t>0){var r=new Date;r.setTime(r.getTime()+24*t*60*60*1e3),l="; expires="+r.toUTCString()}document.cookie=a?i?o+"="+(s||"")+l+"; Path=/; SameSite="+n+"; Domain="+i+"; Secure="+a+";":o+"="+(s||"")+l+"; Path=/; SameSite="+n+"; Secure="+a+";":i?o+"="+(s||"")+l+"; Path=/; SameSite="+n+";Domain="+i+"; ":o+"="+(s||"")+l+"; Path=/; SameSite="+n+";"},get:function(o){for(var e=o+"=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var i=t[n];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e)){var a=i.substring(e.length,i.length);return window.atob(a)}}}},r={documentReady:function(o){"loading"!==document.readyState?o():document.addEventListener("DOMContentLoaded",o)}};function d(o){r.documentReady(function(){if(n.modal=document.getElementById(n.props.dialogContainerID),n.modal)n.$modal.modal("show");else{t.info("\nload consent modal"),n.modal=document.createElement("div"),n.modal.id=n.props.dialogContainerID,n.modal.style.display="none",n.modal.setAttribute("class","modal fade"),n.modal.setAttribute("tabindex","-1"),n.modal.setAttribute("role","dialog"),n.modal.setAttribute("aria-labelledby",n.props.dialogContainerID),document.body.append(n.modal),n.$modal=$(n.modal),n.$modal.on("show.bs.modal",function(){}),n.$modal.on("hidden.bs.modal",function(){!function(o,e){for(var t=Array.prototype.slice.call(arguments,2),n=o.split("."),i=n.pop(),a=0;a<n.length;a++)e=e[n[a]];e[i].apply(e,t)}(n.props.postSelectionCallback,window)});var o=n.props.contentURL+"/index.html";$.get(o).done(function(o){t.info("\nloading consent modal: successfully"),n.modal.innerHTML=o,n.modal.innerHTML=$("#"+n.props.xhrDataElement).eq(0).html(),n.modal.style.display="block",$(n.modal).modal({backdrop:"static",keyboard:!1}),n.$buttonDoNotAgree=$("#bccs-buttonDoNotAgree"),n.$buttonAgree=$("#bccs-buttonAgree"),n.$buttonSave=$("#bccs-buttonSave"),n.$buttonAgreeAll=$("#bccs-buttonAgreeAll"),t.info("\nload/initialze options from cookie"),p(),c(),$("#bccs-options").on("hide.bs.collapse",function(){i=!1,p()}).on("show.bs.collapse",function(){i=!0,p()}),t.info("\ninitialze event handler"),n.$buttonDoNotAgree.click(function(){l.set(n.props.cookieName,JSON.stringify(g(!1)),0,n.props.cookieSameSite,n.props.cookieDomain,a),n.$modal.modal("hide"),window.location.href="/445.html"}),n.$buttonAgree.click(function(){u()}),n.$buttonSave.click(function(){$("#bccs-options").collapse("hide"),l.set(n.props.cookieName,JSON.stringify(g()),n.props.cookieStorageDays,n.props.cookieSameSite,n.props.cookieDomain,a),n.$modal.modal("hide"),c()}),n.$buttonAgreeAll.click(function(){$("#bccs-options").collapse("hide"),u(),c()}),n.$modal.modal("show")}).fail(function(){t.error("\nloading consent modal: failed"),t.warn("\nprobably no `contentURL` set")})}}.bind(this))}function c(){var o=n.getSettings();if(o)for(var e in o){n.$modal.find("#bccs-options .bccs-option[data-name='"+e+"'] input[type='checkbox']").prop("checked",o[e])}}function p(){i?(n.$buttonDoNotAgree.hide(),n.$buttonAgree.hide(),n.$buttonSave.show(),n.$buttonAgreeAll.show()):(n.$buttonDoNotAgree.show(),n.$buttonAgree.show(),n.$buttonSave.hide(),n.$buttonAgreeAll.hide())}function g(o){for(var e=n.$modal.find("#bccs-options .bccs-option"),t={},i=0;i<e.length;i++){var a=e[i],s=a.getAttribute("data-name");if("necessary"===s)t[s]=!0;else if(void 0===o){var l=$(a).find("input[type='checkbox']");t[s]=l.prop("checked")}else t[s]=!!o}return t}function u(){l.set(n.props.cookieName,JSON.stringify(g(!0)),n.props.cookieStorageDays,n.props.cookieSameSite,n.props.cookieDomain,a),n.$modal.modal("hide")}e=this.props.whitelisted.indexOf(window.location.pathname)>-1;var m=l.get(this.props.cookieName);void 0!==m&&"false"!==m||!this.props.autoShowDialog||e||d(),t.info("\ninitializing core module finished"),t.info("\nstate: finished"),this.showDialog=function(){(e=this.props.whitelisted.indexOf(window.location.pathname)>-1)||d()},this.getSettings=function(o){if(l.get(n.props.cookieName)){var e=JSON.parse(l.get(n.props.cookieName));return void 0===o?e:!!e&&e[o]}}}
